{
  "kind": "build_request",
  "title": "Add backend isCallerAdmin() method for AdminGuard",
  "projectName": "PREMJI StudyHub",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Implement a backend canister method `isCallerAdmin()` in `backend/main.mo` as a `public query ({ caller })` function that returns whether `caller` is an admin using the existing access control state, so the frontend `useGetAdminStatus()` / `AdminGuard` can call `actor.isCallerAdmin()` successfully.",
      "target": "backend",
      "source": {
        "messageIds": [
          "recent-messages"
        ],
        "quotes": [
          "add isCallerAdmin into backend now (FINAL)",
          "Your backend STILL has no isCallerAdmin function. The frontend checks it inside AdminGuard, so admin will always fail."
        ]
      },
      "acceptanceCriteria": [
        "The canister exposes `isCallerAdmin : () -> (bool) query` (or equivalent) in the generated Candid/actor interface.",
        "Calling `isCallerAdmin()` from an authenticated identity returns `true` when the caller is an admin and `false` otherwise.",
        "The method does not trap for non-admin callers; it must return `false` rather than throwing.",
        "Frontend admin status query (`useGetAdminStatus`) no longer throws the error `isCallerAdmin method not available on actor` and `AdminGuard` can proceed past the permission-check step for admin users."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in `backend/main.mo`; do not introduce additional backend services."
  ],
  "nonGoals": [
    "Changing frontend admin-guard UI/UX logic.",
    "Reworking how admin principals are seeded or managed beyond exposing the missing `isCallerAdmin()` method."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}